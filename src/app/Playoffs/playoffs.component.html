<div *ngIf="modalOpen" id="playoffModal" class="result-modal">
    <div class="modal-content">
       <form class='add-player' (ngSubmit)="validateGame()" #playoffForm="ngForm">
            <div class='validation-notices'>
                <div id="error" *ngIf="validatorBlank" class="alert alert-danger">
                    You must select a validator.
                </div>
                <div id="error" *ngIf="scoreInvalid" class="alert alert-danger">
                    The coin differential must be a number between 1 and 8 inclusive.
                </div>
                <div id="error" *ngIf="scoreBlank" class="alert alert-danger">
                    The coin differential cannot be blank.
                </div>
            </div>
            <h3 id="who-won">Advancing {{convertToName(modalWinner.team)}} <br><br> Who Validated the Queen?</h3>
            <div class="radio-container first">
                <input type="radio" value="team1" name="validator" [(ngModel)]="validator" /> <label>{{convertToName(modalWinner.team)}}</label>
                <span class="radio-button"></span>
            </div>
            <div class="radio-container second">
                <input type="radio" value="team2" name="validator" [(ngModel)]="validator" /> <label>{{convertToName(modalLoser.team)}}</label>
                <span class="radio-button"></span>
            </div>
            <div>
                <h3 id="score-diff">Score Differential: </h3>
                <input class="diff-input" type="number" min="1" max="8" name="differential" [(ngModel)]="scoreDifferential"/>
            </div>
            <div>
                <input class='main-buttons create-button' type="submit" value="Enter Result"/>
                <button type="button" class="main-buttons clear-button" (click)='closeModal()'>Cancel</button>
            </div>
        </form>
    </div>
</div>
<div class="playoff-content">
    <div class='notice-container'>
        <p id='notice'></p>
    </div>
    <div class="back-button">
        <button class="main-buttons create-button" (click)='goBack()'>« Tournament List</button>
        <button class="main-buttons create-button" (click)='viewGroupStage()'>View Group Stage</button>
    </div>
    <hr id="playoff-hr" />
    <!--<h2>Playoffs</h2>-->
    <div class='button-set' *ngIf="!isOver">
        <button class="main-buttons clear-button" (click)='resetBracket()'>Clear Changes</button>
        <button class="main-buttons add-all-button" (click)='saveBracket()'>Save Bracket</button>
        <div *ngIf="tournamentWinner" id="endtourny"><button class="main-buttons end-button" (click)='endTournament()'>End Tournament</button></div>
        <div *ngIf="!tournamentWinner" id="endtourny" ngbTooltip="You must advance a player to the winner's box first." placement="right"><button class="main-buttons end-button" (click)='endTournament()' disabled>End Tournament</button></div>
    </div>
    <!--<h2 class='playoff-prompt' *ngIf="tournamentWinner">This tournament is complete!</h2>-->
    <div *ngIf="bracket && playInRound" class='flex-container'>
        <div class="bracket-container">
            <div [ngClass]="{'play-in-box': playInRound.length > 0}" *ngIf="bracket">
                <h3 *ngIf="playInRound.length > 0">Play-in Matches</h3>
                <div *ngFor='let matchup of indexArray(playInRound.length / 2); let i = index;'>
                    <div class='bracket-box-play-in'>
                        <div class="bracket-half">
                            <p>{{playInRound[2 * i].playoffSeed}} {{convertToName(playInRound[2 * i].team)}}</p> 
                            <button id="advance-button" *ngIf="!isOver" (click)="openModal(playInRound[2 * i], playInRound[2 * i + 1], -1)">»</button>
                        </div>
                        <hr />
                        <div class="bracket-half">
                            <p>{{playInRound[2 * i + 1].playoffSeed}} {{convertToName(playInRound[2 * i + 1].team)}}</p> 
                            <button id="advance-button" *ngIf="!isOver" (click)="openModal(playInRound[2 * i + 1], playInRound[2 * i], -1)">»</button>
                        </div>
                        </div>
                </div>
            </div>
            <div *ngFor='let round of bracket; let j = index' class='flex-column'>
                <div class='bracket-box' *ngFor='let matchup of indexArray(round.length / 2); let i = index;'>
                    <div class="bracket-half">
                        <p *ngIf="!isEmpty(round[2 * i])">{{round[2 * i].playoffSeed}} {{convertToName(round[2 * i].team)}}</p> 
                        <button id="advance-button" *ngIf="!isEmpty(round[2 * i]) && !isEmpty(round[2 * i + 1]) && !isOver" (click)="openModal(round[2 * i], round[2 * i + 1], j)">»</button>
                        <p *ngIf="isEmpty(round[2 * i])" class='empty-slot'></p>
                    </div>
                    <hr />
                    <div class="bracket-half">
                        <p *ngIf="!isEmpty(round[(2 * i) + 1])">{{round[(2 * i) + 1].playoffSeed}} {{convertToName(round[(2 * i) + 1].team)}} </p> 
                        <button id="advance-button" *ngIf="!isEmpty(round[2 * i + 1]) && !isEmpty(round[2 * i]) && !isOver" (click)="openModal(round[2 * i + 1], round[2 * i], j)">»</button>
                        <p *ngIf="isEmpty(round[(2 * i) + 1])" class='empty-slot'></p>
                    </div>
                </div>
            </div>
            <div class='flex-column'>
                <div class='bracket-box-winner'>
                    <p *ngIf="tournamentWinner">{{convertToName(tournamentWinner)}}</p>
                    <p *ngIf="!tournamentWinner" class='empty-slot'></p>
                    <img id="trophy" src='../../assets/images/trophy.png' width="20px" height="20px" />
                </div>
            </div>
        </div>
    </div>
</div>


